That's an excellent plan. Designing the data model with distinct tables for users, accounts, and transactions is the most robust way to handle the complexities of Accounts Receivable (AR), Accounts Payable (AP), and Unearned Revenue (UR) within a fund-sharing system.

We will proceed with a **Seven-Table System Design** for maximum clarity and audibility, separating **Foundational Data** (Users, Accounts), **Core Data** (Transactions Log), and **Status Data** (The four derived lists).

---

## ðŸ’¾ The Seven-Table Data Model (For Expense Sharing and Debt Tracking)

### I. Foundational Data Tables (The Reference Data)

These tables define **who** is involved and **what** the financial categories are.

#### 1. User Table (T_User)

Stores basic information about the people involved (A, B, C, D).

| Field Name   | Data Type | Constraint  | Description                      | Example       |
| :----------- | :-------- | :---------- | :------------------------------- | :------------ |
| **UserID**   | INT       | Primary Key | Unique ID for the person/entity. | 1 (User A)    |
| **UserName** | VARCHAR   | NOT NULL    | Display name of the user.        | User A        |
| **Email**    | VARCHAR   | UNIQUE      | Contact information.             | a@example.com |
| **Status**   | VARCHAR   | NOT NULL    | `Active`, `Inactive`.            | Active        |

#### 2. Account Table (T_Account)

Defines all financial categories (Cash, AR, AP, UR, Expense). This is the system's "Chart of Accounts."

| Field Name      | Data Type | Constraint  | Description                                                       | Example             |
| :-------------- | :-------- | :---------- | :---------------------------------------------------------------- | :------------------ |
| **AccountID**   | INT       | Primary Key | Unique ID for the financial category.                             | 101                 |
| **AccountName** | VARCHAR   | NOT NULL    | Human-readable name (e.g., "Cash Account").                       | Accounts Receivable |
| **AccountType** | VARCHAR   | NOT NULL    | **Major Classification** (`Asset`, `Liability`, `Expense`, etc.). | Asset               |
| **SubType**     | VARCHAR   | NOT NULL    | Detailed sub-classification.                                      | AR                  |
| **IsExternal**  | BOOLEAN   | NOT NULL    | `True` for physical money, `False` for virtual/tracking.          | False               |

---

### II. Core Data Table (The Immutable Source)

#### 3. Transactions Log (T_Log)

The single source of truth. Every financial event is an **immutable, appended record**. It links users to accounts via the transaction.

| Field Name          | Data Type | Constraint              | Description                                                                   | Example                 |
| :------------------ | :-------- | :---------------------- | :---------------------------------------------------------------------------- | :---------------------- |
| **TransactionID**   | INT       | Primary Key             | Unique identifier for the transaction.                                        | 2001                    |
| **TransactionDate** | DATETIME  | NOT NULL                | Time the transaction occurred.                                                | 2025-12-13 18:00:00     |
| **InitiatorID**     | INT       | Foreign Key (T_User)    | The user who initiated the action (e.g., User A paid the bill).               | 1 (User A)              |
| **CounterpartyID**  | INT       | Foreign Key (T_User)    | The user who is the subject of the transaction (e.g., User C in pre-payment). | 3 (User C)              |
| **AccountID**       | INT       | Foreign Key (T_Account) | The **financial category** being affected (e.g., Cash, AR, UR).               | 101 (Cash)              |
| **Amount**          | DECIMAL   | NOT NULL                | The value change. (Positive for increase, Negative for decrease).             | +50.00                  |
| **Narrative**       | VARCHAR   |                         | Short description of the event.                                               | Received C's Prepayment |

---

### III. Status Data Tables (The Derived Results)

These tables represent the **current state** and are typically generated by querying and aggregating the `T_Log`.

#### 4. Cash Balance Table (T_Cash_Status)

Represents the **Running Ledger** or the result of the flow of cash.

| Field Name         | Data Type | Constraint  | Description                           | Example    |
| :----------------- | :-------- | :---------- | :------------------------------------ | :--------- |
| **AccountID**      | INT       | Primary Key | ID of the Cash/Bank account.          | 101        |
| **CurrentBalance** | DECIMAL   | NOT NULL    | **Real-time calculated net balance.** | $-50.00$   |
| **LastUpdated**    | DATETIME  | NOT NULL    | Timestamp of the last balance update. | 2025-12-15 |

#### 5. Accounts Receivable List (T_AR_Status)

The current list of **claims A has against others**.

| Field Name               | Data Type | Constraint           | Description                                            | Example    |
| :----------------------- | :-------- | :------------------- | :----------------------------------------------------- | :--------- |
| **ARItemID**             | INT       | Primary Key          | Unique ID for the specific outstanding claim.          | 3001       |
| **DebtorID**             | INT       | Foreign Key (T_User) | The user who owes A money (B or D).                    | 2 (User B) |
| **AmountOwed**           | DECIMAL   | NOT NULL             | **Net amount B currently owes A.**                     | $15.00$    |
| **RelatedTransactionID** | INT       | Foreign Key (T_Log)  | Links to the original transaction that created the AR. | 2005       |

#### 6. Accounts Payable List (T_AP_Status)

The current list of **liabilities A has to others** (e.g., A owes a refund).

| Field Name               | Data Type | Constraint           | Description                                            | Example    |
| :----------------------- | :-------- | :------------------- | :----------------------------------------------------- | :--------- |
| **APItemID**             | INT       | Primary Key          | Unique ID for the specific outstanding liability.      | 4001       |
| **CreditorID**           | INT       | Foreign Key (T_User) | The user A owes money to (e.g., User C for refund).    | 3 (User C) |
| **AmountDue**            | DECIMAL   | NOT NULL             | **Net amount A currently owes C.**                     | $25.00$    |
| **RelatedTransactionID** | INT       | Foreign Key (T_Log)  | Links to the original transaction that created the AP. | 2007       |

#### 7. Unearned Revenue List (T_UR_Status)

The current list of **prepayments A received** that haven't been offset or refunded yet. _Note: In a settlement process, this often quickly transitions to AP or is cleared._

| Field Name        | Data Type | Constraint           | Description                                         | Example    |
| :---------------- | :-------- | :------------------- | :-------------------------------------------------- | :--------- |
| **URItemID**      | INT       | Primary Key          | Unique ID for the specific prepayment liability.    | 5001       |
| **PayerID**       | INT       | Foreign Key (T_User) | The user who made the prepayment (B or C).          | 2 (User B) |
| **AmountPrepaid** | DECIMAL   | NOT NULL             | **Net amount B prepaid before settlement.**         | $10.00$    |
| **SettledAmount** | DECIMAL   | NOT NULL             | Amount of prepayment already used to offset a cost. | $10.00$    |

---

This seven-table structure ensures that the financial _nature_ of the transaction (`AccountID`) and the _person_ involved (`UserID`) are always clearly and separately tracked, providing robust auditing for all your cash, AR, AP, and UR requirements.

Would you like to see a sample flow of how a single transaction (like a pre-payment) would affect the `T_Log` and then update these status tables?
